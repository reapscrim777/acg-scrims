<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AC GDANSK - Historia Scrimów</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Strona Główna</a></li>
                <li><a href="test1.html">Historia Scrimów</a></li>
                <li><a href="test2.html">Statystyki Zawodników</a></li>
                <li><a href="test3.html">test3</a></li>
                <li><a href="test4.html">test4</a></li>
                <li><a href="test5.html">test5</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h1>Historia Scrimów</h1>

        <section class="stats-summary">
            <div class="stats-item">Ilość scrimów: <span id="totalScrims">0</span></div>
            <div class="stats-item">Wygrane: <span id="wins">0</span></div>
            <div class="stats-item">Przegrane: <span id="losses">0</span></div>
            <div class="stats-item">% zwycięstw: <span id="winRate">0%</span></div>
        </section>

        <section class="add-scrim-form">
            <h2>Dodaj nowy Scrim</h2>
            <form id="scrimForm">
                <div class="form-group">
                    <label for="scrimDate">Data:</label>
                    <input type="date" id="scrimDate" required>
                </div>
                <div class="form-group">
                    <label for="scrimResult">Wynik:</label>
                    <select id="scrimResult" required>
                        <option value="">Wybierz wynik</option>
                        <option value="WIN">WIN</option>
                        <option value="LOSE">LOSE</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scrimTime">Czas Gry:</label>
                    <input type="text" id="scrimTime" placeholder="np. 35:12" required>
                </div>
                <div class="form-group team-champions">
                    <label>Nasze Postacie:</label>
                    <input type="text" class="our-champion-input" placeholder="Top" required>
                    <input type="text" class="our-champion-input" placeholder="Jungle" required>
                    <input type="text" class="our-champion-input" placeholder="Mid" required>
                    <input type="text" class="our-champion-input" placeholder="Adc" required>
                    <input type="text" class="our-champion-input" placeholder="Support" required>
                </div>
                <div class="form-group team-champions">
                    <label>Postacie Przeciwników:</label>
                    <input type="text" class="enemy-champion-input" placeholder="Top" required>
                    <input type="text" class="enemy-champion-input" placeholder="Jungle" required>
                    <input type="text" class="enemy-champion-input" placeholder="Mid" required>
                    <input type="text" class="enemy-champion-input" placeholder="Adc" required>
                    <input type="text" class="enemy-champion-input" placeholder="Support" required>
                </div>
                <button type="submit">Dodaj Scrim</button>
            </form>
        </section>

        <section class="scrim-history">
            <h2>Poprzednie Scrimy</h2>
            <table>
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Wynik</th>
                        <th>Czas Gry</th>
                        <th>Nasze Postacie</th>
                        <th>Postacie Przeciwników</th>
                        <th>Akcje</th>
                    </tr>
                </thead>
                <tbody id="scrimTableBody"></tbody>
            </table>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 AC GDANSK. Wszelkie prawa zastrzeżone.</p>
    </footer>

    <script>
        // Konfiguracja Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database(app);

        const scrimForm = document.getElementById('scrimForm');
        const scrimTableBody = document.getElementById('scrimTableBody');
        const scrimDateInput = document.getElementById('scrimDate');
        const scrimResultInput = document.getElementById('scrimResult');
        const scrimTimeInput = document.getElementById('scrimTime');
        const ourChampionInputs = document.querySelectorAll('.our-champion-input');
        const enemyChampionInputs = document.querySelectorAll('.enemy-champion-input');

        const totalScrimsSpan = document.getElementById('totalScrims');
        const winsSpan = document.getElementById('wins');
        const lossesSpan = document.getElementById('losses');
        const winRateSpan = document.getElementById('winRate');

        let scrimsData = [];

        function updateStats() {
            const totalScrims = scrimsData.length;
            const wins = scrimsData.filter(scrim => scrim.result === 'WIN').length;
            const losses = scrimsData.filter(scrim => scrim.result === 'LOSE').length;
            const winRate = totalScrims > 0 ? ((wins / totalScrims) * 100).toFixed(2) : 0;

            totalScrimsSpan.textContent = totalScrims;
            winsSpan.textContent = wins;
            lossesSpan.textContent = losses;
            winRateSpan.textContent = `${winRate}%`;
        }

        function renderTable() {
            scrimTableBody.innerHTML = '';
            scrimsData.forEach(scrim => {
                const row = document.createElement('tr');
                const resultClass = scrim.result.toLowerCase();

                const ourChampionsHtml = scrim.our.split(',').map(name => {
                    const trimmedName = name.trim();
                    return `<span>${trimmedName}</span>`;
                }).join(', ');

                const enemyChampionsHtml = scrim.enemy.split(',').map(name => {
                    const trimmedName = name.trim();
                    return `<span>${trimmedName}</span>`;
                }).join(', ');

                row.innerHTML = `
                    <td>${scrim.date}</td>
                    <td class="${resultClass}">${scrim.result}</td>
                    <td>${scrim.time}</td>
                    <td>${ourChampionsHtml}</td>
                    <td>${enemyChampionsHtml}</td>
                    <td><button class="delete-btn" data-id="${scrim.id}">Usuń</button></td>
                `;
                scrimTableBody.appendChild(row);
            });

            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const idToDelete = parseInt(this.dataset.id);
                    deleteScrim(idToDelete);
                });
            });

            updateStats();
        }

        function deleteScrim(id) {
            scrimsData = scrimsData.filter(scrim => scrim.id !== id);
            renderTable();
        }

        scrimForm.addEventListener('submit', function(event) {
            event.preventDefault();

            const newId = scrimsData.length > 0 ? Math.max(...scrimsData.map(s => s.id)) + 1 : 1;

            const ourChampionsArray = Array.from(ourChampionInputs).map(input => input.value.trim()).filter(Boolean);
            const ourChampionsString = ourChampionsArray.join(', ');

            const enemyChampionsArray = Array.from(enemyChampionInputs).map(input => input.value.trim()).filter(Boolean);
            const enemyChampionsString = enemyChampionsArray.join(', ');

            const newScrim = {
                id: newId,
                date: scrimDateInput.value,
                result: scrimResultInput.value,
                time: scrimTimeInput.value,
                our: ourChampionsString,
                enemy: enemyChampionsString
            };

            scrimsData.unshift(newScrim);
            renderTable();
            scrimForm.reset();

            const scrimsRef = database.ref('scrims');
            scrimsRef.push(newScrim);
        });

        document.addEventListener('DOMContentLoaded', () => {
            const scrimsRef = database.ref('scrims');
            scrimsRef.on('value', snapshot => {
                scrimsData = [];
                snapshot.forEach(childSnapshot => {
                    scrimsData.push(childSnapshot.val());
                });
                renderTable();
            });
        });
    </script>
</body>
</html>
